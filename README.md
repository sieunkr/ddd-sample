# 도메인 주도 설계 JPA 엔티티 분리 샘플 예제

## 개요
- 도메인 주도 설계의 철학에 맞게 도메인 엔티티와 JPA 엔티티를 별도의 클래스로 분리하는 방법에 대해서 소개함
- 스터디 발표를 위해서 작성한 임시 소스코드로 깔끔한 코드는 아니므로, 대충 참고만 하길 바람
- 최범균님의 "DDD START" 를 참고하였고, 해당 책은 2022년 새로 출판되었으니 구매해서 읽어보길 바람

## 도메인 주도 설계란?
- 도메인 주도 설계에 대한 이론은 해당 문서에서 생략한다. (자세한 내용은 스터디 시간에 설명하기로)
- (이상) 도메인 객체인 엔티티,값객체 는 데이터베이스에 의존하지 않도록 해야 한다. 즉, JPA 엔티티와 같은 클래스로 사용하는 것은 원칙적으로 옳은 방향은 아니다.
- (현실) 하지만, 별도의 클래스로 분리하는 경우 소프트웨어의 유연성은 높아지겠지만, 복잡도가 증가할 수 있다.
- 정답은 없다. 장단점을 파악한 후, 각자 프로젝트 상황에 맞게 어떤 방향으로 갈지 고민해보길 바란다.

## 샘플 코드 소개
- 샘플 코드는, 레이어드 아키텍처 와 클린 아키텍처를 혼합한 형태로 작성하였음
- 도메인 주도 설계에서 아키텍처는 옵션일 뿐이므로, 각자 알아서 아키텍처를 선택하면 된다. (예 헥사고날 아키텍처, 클린 아키텍처 등등)
- ddd-start-like : 최범균님의 소스코드와 유사한 방식, 도메인 엔티티와 JPA 엔티티는 같은 클래스로 사용한다.
- ddd-start-modify : 도메인 엔티티와 JPA 엔티티를 별도의 클래스로 분리한 후, 매핑하는 과정을 수행한다. infrastructure 영역에 데이터베이스 상세 구현을 작성한다. 단, repository 는 도메인 영역에 존재해야 한다. repository 를 인터페이스로 정의한 후, infrastructure 레이어에서 구현체를 작성하는 방식이다. DIP 개념이 적용된다. 
- ddd-start-jdbctemplate : ddd-start-modify 와 유사한 방법이지만, JPA 를 사용하지 않는다. 
- ddd-start-modify 와 ddd-start-jdbctemplate 는 도메인 영역이 동일하다. 즉, 데이터베이스 구현체를 어떤 기술을 쓰는지에 전혀 영향을 받지 않는다. 클린 아키텍처 개념과 동일하다. 
- 반면에 ddd-start-like 는 JPA 개념이 도메인 영역까지 침범하였다. 도메인 객체는 데이터베이스 에 강하게 의존한다. 

## 실무에서는 어떻게 사용할까? 
- 실무에서는 JPA 를 사용하는 환경이라면 ddd-start-like 방식을 주로 사용하는 것 같다.
- 실무에서 클래스 분리를 하는 방향이라면 굳이 JPA 를 사용해야하는지 의문이다. 도메인 주도 설계 철학에 맞게 개발하면 굳이 RDMBS 로 안해도 될것 같다는 생각이다. 오히려 NoSQL 이 적합할 수 있다. 어쩃든, 도메인 주도 철학에 의하면 데이터베이스는 옵션일 뿐이다. NoSQL, RDBMS 어떤 걸 선택해도 상관없도록 아키텍처를 작성해야 한다. 하지만, 현실에서 과연 그렇게 될까? 일반적으로 MySQL(AWS RDB)로 하는걸로 시작부터 정하고, JPA 엔티티 부터 정의하지 않나? 
- 아직은, 실무에서는 도메인 주도 설계 보다는 데이터베이스 주도 설계에 익숙한 상황인 것 같다.

## 결론
- 어쨋든, 장단점이 분명하고 각 프로젝트 상황에 맞게 잘 선택하면 된다.
- 최종 목표는, 도메인 지식을 잘 이해하는 것이다. 그리고, 가치있는 소프트웨어를 만들어야 한다는 최종 목표를 잊지 않도록 하자.  
